<!DOCTYPE html>
<html>
  <head>
    <title>Liste des enfants</title>
    <style>
        /* CSS pour le tableau d'employés */
table {
    border-collapse: collapse;
    width: 100%;
    margin-bottom: 20px;
  }
  
  th, td {
    text-align: left;
    padding: 8px;
    border-bottom: 1px solid #ddd;
  }
  
  tr:hover {
    background-color: #f5f5f5;
  }
  
  /* CSS pour les boutons */
  button {
    background-color: #4CAF50;
    color: white;
    padding: 8px 16px;
    border: none;
    border-radius: 4px;
    cursor: pointer;
  }
  
  button:hover {
    background-color: #3e8e41;
  }
  
  .deleteButton {
    background-color: #f44336;
  }
  
  .deleteButton:hover {
    background-color: #da190b;
  }
  
  /* CSS pour la barre de recherche */
  #searchBar {
    width: 100%;
    padding: 12px 20px;
    margin-bottom: 20px;
    box-sizing: border-box;
    border: 2px solid #ccc;
    border-radius: 4px;
  }
  
  /* CSS pour la boîte modale de confirmation de suppression */
  .modal {
    display: none; /* Masque la boîte modale par défaut */
    position: fixed; /* Permet de positionner la boîte modale par rapport à la fenêtre du navigateur */
    z-index: 1; /* Met la boîte modale au-dessus de tout le contenu */
    left: 0;
    top: 0;
    width: 100%; /* La largeur de la boîte modale prend 100% de la largeur de la fenêtre */
    height: 100%; /* La hauteur de la boîte modale prend 100% de la hauteur de la fenêtre */
    overflow: auto; /* Permet de faire défiler la boîte modale si son contenu dépasse de la fenêtre */
    background-color: rgba(0,0,0,0.4); /* Ajoute un fond noir semi-transparent */
  }
  
  /* Contenu de la boîte modale */
  .modal-content {
    background-color: #fefefe;
    margin: 15% auto; /* Centre la boîte modale verticalement et horizontalement */
    padding: 20px;
    border: 1px solid #888;
    width: 80%; /* Fixe la largeur de la boîte modale */
  }
  
  /* Bouton de fermeture de la boîte modale */
  .close {
    color: #aaa;
    float: right;
    font-size: 28px;
    font-weight: bold;
  }
  
  .close:hover,
  .close:focus {
    color: black;
    text-decoration: none;
    cursor: pointer;
  }
    </style>
  </head>
  <body>
    <h1>Liste des enfants</h1>
    <!-- Barre de recherche -->
    <input type="text" id="searchInput" onkeyup="searchTable()" placeholder="Rechercher un enfant...">

    <!-- Tableau des enfants -->
    <table id="enfantsTable">
      <thead>
        <tr>
          <th>Nom</th>
          <th>Prénom</th>
          <th>Email</th>
          <th>Action</th>
          <th>Action</th>
        </tr>
      </thead>
      <tbody>
        <% if (enfants && enfants.length > 0) { %>
          <% enfants.forEach(function(enfant) { %>
            <tr>
              <td><%= enfant.nom %></td>
              <td><%= enfant.prenom %></td>
              <td><%= enfant.e_mail %></td>
              <td>
                <button id="infos-button" onclick="enfoncerInfos('<%= enfant._id %>');">Informations</button>
              </td>
              <td>
                <button id="delete-button" onclick="enfoncerDelete('<%= enfant._id %>');">Supprimer</button>
              </td>
            </tr>
          <% }); %>
        <% } else { %>
          <tr>
            <td colspan="5">Aucune donnée trouvée.</td>
          </tr>
        <% } %>
      </tbody>
    </table>

    <script>
    //fonctions de la barre de recherche
    const enfantsTable = document.getElementById('enfantsTable');
    function searchTable() {
    // Récupération de la barre de recherche et du tableau d'enfants
    var input = document.getElementById("searchInput");
    var table = document.getElementById("enfantsTable");

    // Récupération de toutes les lignes du tableau sauf l'en-tête
    var rows = table.getElementsByTagName("tr");
    for (var i = 1; i < rows.length; i++) {
      var enfantName = rows[i].getElementsByTagName("td")[0].textContent;
      var enfantFirstName = rows[i].getElementsByTagName("td")[1].textContent;
      var enfantEmail = rows[i].getElementsByTagName("td")[2].textContent;
      var enfantRole = rows[i].getElementsByTagName("td")[3].textContent;

      // Recherche de l'enfant correspondant à la recherche
      if (
        enfantName.toLowerCase().indexOf(input.value.toLowerCase()) > -1 ||
        enfantFirstName.toLowerCase().indexOf(input.value.toLowerCase()) > -1 ||
        enfantEmail.toLowerCase().indexOf(input.value.toLowerCase()) > -1 ||
        enfantRole.toLowerCase().indexOf(input.value.toLowerCase()) > -1
      ) {
        rows[i].style.display = "";
      } else {
        rows[i].style.display = "none";
      }
    }
  }
  
  
  function enfoncerDelete(id) {
    document.getElementById("delete-button").classList.add("active");
    window.location.href = "http://localhost:8000/gestionDesEnfants/" + id + "/supprimer";
  }

  function enfoncerInfos(id) {
    document.getElementById("infos-button").classList.add("active");
    window.location.href = "http://localhost:8000/gestionDesEnfants/" + id + "/informations";
  }
  
</script>

</body>
</html>