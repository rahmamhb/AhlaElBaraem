<!DOCTYPE html>
<html>
  <head>
    <title>Liste du stuff</title>
    <style>
        /* CSS pour le tableau d'employés */
table {
    border-collapse: collapse;
    width: 100%;
    margin-bottom: 20px;
  }
  
  th, td {
    text-align: left;
    padding: 8px;
    border-bottom: 1px solid #ddd;
  }
  
  tr:hover {
    background-color: #f5f5f5;
  }
  
  /* CSS pour les boutons */
  button {
    background-color: #4CAF50;
    color: white;
    padding: 8px 16px;
    border: none;
    border-radius: 4px;
    cursor: pointer;
  }
  
  button:hover {
    background-color: #3e8e41;
  }
  
  .deleteButton {
    background-color: #f44336;
  }
  
  .deleteButton:hover {
    background-color: #da190b;
  }
  
  /* CSS pour la barre de recherche */
  #searchBar {
    width: 100%;
    padding: 12px 20px;
    margin-bottom: 20px;
    box-sizing: border-box;
    border: 2px solid #ccc;
    border-radius: 4px;
  }
  
  /* CSS pour la boîte modale de confirmation de suppression */
  .modal {
    display: none; /* Masque la boîte modale par défaut */
    position: fixed; /* Permet de positionner la boîte modale par rapport à la fenêtre du navigateur */
    z-index: 1; /* Met la boîte modale au-dessus de tout le contenu */
    left: 0;
    top: 0;
    width: 100%; /* La largeur de la boîte modale prend 100% de la largeur de la fenêtre */
    height: 100%; /* La hauteur de la boîte modale prend 100% de la hauteur de la fenêtre */
    overflow: auto; /* Permet de faire défiler la boîte modale si son contenu dépasse de la fenêtre */
    background-color: rgba(0,0,0,0.4); /* Ajoute un fond noir semi-transparent */
  }
  
  /* Contenu de la boîte modale */
  .modal-content {
    background-color: #fefefe;
    margin: 15% auto; /* Centre la boîte modale verticalement et horizontalement */
    padding: 20px;
    border: 1px solid #888;
    width: 80%; /* Fixe la largeur de la boîte modale */
  }
  
  /* Bouton de fermeture de la boîte modale */
  .close {
    color: #aaa;
    float: right;
    font-size: 28px;
    font-weight: bold;
  }
  
  .close:hover,
  .close:focus {
    color: black;
    text-decoration: none;
    cursor: pointer;
  }
    </style>

<script>
  // fonction de recherche
  const employeeTable = document.getElementById('employeeTable');

  function searchTable() {
  // Récupération de la barre de recherche et du tableau des employés
  var input = document.getElementById("searchInput");
  var table = document.getElementById("employeeTable");

  // Récupération de toutes les lignes du tableau sauf l'en-tête
  var rows = table.getElementsByTagName("tr");
  for (var i = 1; i < rows.length; i++) {
    var employeeName = rows[i].getElementsByTagName("td")[0].textContent;
    var employeeFirstName = rows[i].getElementsByTagName("td")[1].textContent;
    var employeeEmail = rows[i].getElementsByTagName("td")[2].textContent;
    var employeeRole = rows[i].getElementsByTagName("td")[3].textContent;

    if (
      employeeName.toLowerCase().indexOf(input.value.toLowerCase()) > -1 ||
      employeeFirstName.toLowerCase().indexOf(input.value.toLowerCase()) > -1 ||
      employeeEmail.toLowerCase().indexOf(input.value.toLowerCase()) > -1 ||
      employeeRole.toLowerCase().indexOf(input.value.toLowerCase()) > -1
    ) {
      rows[i].style.display = "";
    } else {
      rows[i].style.display = "none";
    }
  }
}

// fonctions que j'ai crée pour les redirections
function enfoncerDelete(id) {
  document.getElementById("delete-button").classList.add("active");
  window.location.href = "http://localhost:8000/gestionDeLequipe/" + id + "/supprimer";
}
function enfoncerAdd() {
  document.getElementById("add-button").classList.add("active");
  window.location.href = "http://localhost:8000/gestionDeLequipe/ajouter";
}

function enfoncerEquipe() {
  document.getElementById("equipe").classList.add("active");
  window.location.href = "http://localhost:8000/gestionDeLequipe";
  }
  function enfoncerEnfant() {
  document.getElementById("enfants").classList.add("active");
  window.location.href = "http://localhost:8000/gestionDesEnfants";
  }
  function enfoncerSite() {
  document.getElementById("site").classList.add("active");
  window.location.href = "http://localhost:8000/gestionDuSite";
  }
</script>

  </head>
  <body>
    <div>
      <button id = "equipe" onclick="enfoncerEquipe()">gestion de l'equipe</button>
      <button id = "enfants" onclick="enfoncerEnfant()">
        gestion des enfants
      </button>
      <button id = "site" onclick="enfoncerSite()">
        gestion du site
      </button>
    </div>
    <h1>Liste des employés</h1>
    <!-- Barre de recherche -->
    <input type="text" id="searchInput" onkeyup="searchTable()" placeholder="Rechercher un employé...">

    <!-- Tableau des employés -->
    <table id="employeeTable">
      <thead>
        <tr>
          <th>Nom</th>
          <th>Prénom</th>
          <th>Email</th>
          <th>Rôle</th>
          <th>Action</th>
        </tr>
      </thead>
      <tbody>
        <% if (stuffs && stuffs.length > 0) { %>
          <% stuffs.forEach(function(stuff) { %>
            <tr>
              <td><%= stuff.nom %></td>
              <td><%= stuff.prenom %></td>
              <td><%= stuff.e_mail %></td>
              <td><%= stuff.role %></td>
              <td>
                <button id="delete-button" onclick="enfoncerDelete('<%= stuff._id %>');">Supprimer</button>
              </td>
            </tr>
          <% }); %>
        <% } else { %>
          <tr>
            <td colspan="5">Aucune donnée trouvée.</td>
          </tr>
        <% } %>
      </tbody>
    </table>

    <!-- Bouton d'ajout d'un nouvel employé -->
    <button id="add-button" onclick="enfoncerAdd()">Ajouter un employé</button>
</body>
</html>